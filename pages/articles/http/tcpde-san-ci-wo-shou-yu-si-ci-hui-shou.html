<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>TCP的三次握手与四次挥手 | frenchleave</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="冯春齐 fengchunqi frenchleave blog">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <meta name="keywords" content="冯春齐,fengchunqi,frenchleave blog">
    
    <link rel="preload" href="/assets/css/0.styles.5bd792e7.css" as="style"><link rel="preload" href="/assets/js/app.5f2c876c.js" as="script"><link rel="preload" href="/assets/js/3.83a3aa92.js" as="script"><link rel="preload" href="/assets/js/1.1efd4ac0.js" as="script"><link rel="preload" href="/assets/js/53.e9c895e1.js" as="script"><link rel="preload" href="/assets/js/11.a144a0bb.js" as="script"><link rel="prefetch" href="/assets/js/10.4c13b9ab.js"><link rel="prefetch" href="/assets/js/100.d13108ea.js"><link rel="prefetch" href="/assets/js/101.8b4f31c9.js"><link rel="prefetch" href="/assets/js/102.000253bd.js"><link rel="prefetch" href="/assets/js/103.ce416ec5.js"><link rel="prefetch" href="/assets/js/104.841270ec.js"><link rel="prefetch" href="/assets/js/105.1ca41f38.js"><link rel="prefetch" href="/assets/js/106.41ec9750.js"><link rel="prefetch" href="/assets/js/107.8520aeb3.js"><link rel="prefetch" href="/assets/js/108.611c4e52.js"><link rel="prefetch" href="/assets/js/109.298ca7d9.js"><link rel="prefetch" href="/assets/js/110.14c6da03.js"><link rel="prefetch" href="/assets/js/111.acb6b7ee.js"><link rel="prefetch" href="/assets/js/112.b0bb3144.js"><link rel="prefetch" href="/assets/js/113.d6934473.js"><link rel="prefetch" href="/assets/js/114.2ee803f2.js"><link rel="prefetch" href="/assets/js/115.dde29f60.js"><link rel="prefetch" href="/assets/js/116.0b7fd8cf.js"><link rel="prefetch" href="/assets/js/117.77d84132.js"><link rel="prefetch" href="/assets/js/118.90c56ec2.js"><link rel="prefetch" href="/assets/js/119.bcbfb1fa.js"><link rel="prefetch" href="/assets/js/12.dbebabe7.js"><link rel="prefetch" href="/assets/js/120.c6639f49.js"><link rel="prefetch" href="/assets/js/121.067c6223.js"><link rel="prefetch" href="/assets/js/122.b6df5ee2.js"><link rel="prefetch" href="/assets/js/123.b3718430.js"><link rel="prefetch" href="/assets/js/124.8e594b66.js"><link rel="prefetch" href="/assets/js/125.d793b6d2.js"><link rel="prefetch" href="/assets/js/126.efb142f9.js"><link rel="prefetch" href="/assets/js/127.c00012d5.js"><link rel="prefetch" href="/assets/js/128.24a518bf.js"><link rel="prefetch" href="/assets/js/129.c8a5f14e.js"><link rel="prefetch" href="/assets/js/13.b95f4b03.js"><link rel="prefetch" href="/assets/js/130.c23ac2e5.js"><link rel="prefetch" href="/assets/js/131.4aab106c.js"><link rel="prefetch" href="/assets/js/132.c0efe7b3.js"><link rel="prefetch" href="/assets/js/133.44c810d3.js"><link rel="prefetch" href="/assets/js/134.1a5c0774.js"><link rel="prefetch" href="/assets/js/135.4776cebc.js"><link rel="prefetch" href="/assets/js/136.82f15038.js"><link rel="prefetch" href="/assets/js/137.20075fff.js"><link rel="prefetch" href="/assets/js/138.53434671.js"><link rel="prefetch" href="/assets/js/139.745c47a1.js"><link rel="prefetch" href="/assets/js/14.dfebfba4.js"><link rel="prefetch" href="/assets/js/140.9f2795eb.js"><link rel="prefetch" href="/assets/js/141.c0e397ce.js"><link rel="prefetch" href="/assets/js/142.5f1a594f.js"><link rel="prefetch" href="/assets/js/143.ea5cf5b9.js"><link rel="prefetch" href="/assets/js/144.58c48a99.js"><link rel="prefetch" href="/assets/js/145.7d66dc72.js"><link rel="prefetch" href="/assets/js/15.51e59a06.js"><link rel="prefetch" href="/assets/js/16.7b4f9f2e.js"><link rel="prefetch" href="/assets/js/17.c7f89fe2.js"><link rel="prefetch" href="/assets/js/18.531b5ff0.js"><link rel="prefetch" href="/assets/js/19.0cd78688.js"><link rel="prefetch" href="/assets/js/20.f4f125db.js"><link rel="prefetch" href="/assets/js/21.88dd7d6a.js"><link rel="prefetch" href="/assets/js/22.ef435564.js"><link rel="prefetch" href="/assets/js/23.c84c93dd.js"><link rel="prefetch" href="/assets/js/24.449c8dc9.js"><link rel="prefetch" href="/assets/js/25.5bb87f0c.js"><link rel="prefetch" href="/assets/js/26.d96bd1b2.js"><link rel="prefetch" href="/assets/js/27.eb0b26c0.js"><link rel="prefetch" href="/assets/js/28.85630f33.js"><link rel="prefetch" href="/assets/js/29.89fda983.js"><link rel="prefetch" href="/assets/js/30.2daa466b.js"><link rel="prefetch" href="/assets/js/31.73b09018.js"><link rel="prefetch" href="/assets/js/32.3fe4a858.js"><link rel="prefetch" href="/assets/js/33.1e3cf846.js"><link rel="prefetch" href="/assets/js/34.81b99644.js"><link rel="prefetch" href="/assets/js/35.ef2dcf43.js"><link rel="prefetch" href="/assets/js/36.9687244a.js"><link rel="prefetch" href="/assets/js/37.34403766.js"><link rel="prefetch" href="/assets/js/38.dad1aeec.js"><link rel="prefetch" href="/assets/js/39.f63f9108.js"><link rel="prefetch" href="/assets/js/4.eced67fa.js"><link rel="prefetch" href="/assets/js/40.415ccdbd.js"><link rel="prefetch" href="/assets/js/41.e55ca6be.js"><link rel="prefetch" href="/assets/js/42.c69e27b0.js"><link rel="prefetch" href="/assets/js/43.0350dd79.js"><link rel="prefetch" href="/assets/js/44.5ee92b73.js"><link rel="prefetch" href="/assets/js/45.c14b415d.js"><link rel="prefetch" href="/assets/js/46.0dafc896.js"><link rel="prefetch" href="/assets/js/47.1e610091.js"><link rel="prefetch" href="/assets/js/48.37728963.js"><link rel="prefetch" href="/assets/js/49.5647aa1d.js"><link rel="prefetch" href="/assets/js/5.56199536.js"><link rel="prefetch" href="/assets/js/50.bc9beb26.js"><link rel="prefetch" href="/assets/js/51.bd7213ed.js"><link rel="prefetch" href="/assets/js/52.5eea104b.js"><link rel="prefetch" href="/assets/js/54.6a84724f.js"><link rel="prefetch" href="/assets/js/55.3b35b9e7.js"><link rel="prefetch" href="/assets/js/56.0b5d6d9c.js"><link rel="prefetch" href="/assets/js/57.fc0a2a2b.js"><link rel="prefetch" href="/assets/js/58.73ba0124.js"><link rel="prefetch" href="/assets/js/59.a1bdac44.js"><link rel="prefetch" href="/assets/js/6.36581b04.js"><link rel="prefetch" href="/assets/js/60.80a87628.js"><link rel="prefetch" href="/assets/js/61.0b1eab11.js"><link rel="prefetch" href="/assets/js/62.6aeb81ac.js"><link rel="prefetch" href="/assets/js/63.e791d01f.js"><link rel="prefetch" href="/assets/js/64.9194875f.js"><link rel="prefetch" href="/assets/js/65.6fa17536.js"><link rel="prefetch" href="/assets/js/66.77cd6dae.js"><link rel="prefetch" href="/assets/js/67.e6127c85.js"><link rel="prefetch" href="/assets/js/68.d18a4053.js"><link rel="prefetch" href="/assets/js/69.7b53546b.js"><link rel="prefetch" href="/assets/js/7.d48afba3.js"><link rel="prefetch" href="/assets/js/70.a7f3bd6b.js"><link rel="prefetch" href="/assets/js/71.b74f72a3.js"><link rel="prefetch" href="/assets/js/72.67c919ba.js"><link rel="prefetch" href="/assets/js/73.4a4b736b.js"><link rel="prefetch" href="/assets/js/74.3ca4c084.js"><link rel="prefetch" href="/assets/js/75.9f9f7daa.js"><link rel="prefetch" href="/assets/js/76.9af69982.js"><link rel="prefetch" href="/assets/js/77.0f387408.js"><link rel="prefetch" href="/assets/js/78.fb7c7b3e.js"><link rel="prefetch" href="/assets/js/79.158ae522.js"><link rel="prefetch" href="/assets/js/8.4b2dcb4b.js"><link rel="prefetch" href="/assets/js/80.18cb32c9.js"><link rel="prefetch" href="/assets/js/81.7875050f.js"><link rel="prefetch" href="/assets/js/82.ae7f6b69.js"><link rel="prefetch" href="/assets/js/83.25e1e16b.js"><link rel="prefetch" href="/assets/js/84.3b35b4c6.js"><link rel="prefetch" href="/assets/js/85.d8c5b916.js"><link rel="prefetch" href="/assets/js/86.9b15ef01.js"><link rel="prefetch" href="/assets/js/87.53b91789.js"><link rel="prefetch" href="/assets/js/88.e670dc2f.js"><link rel="prefetch" href="/assets/js/89.01ab2770.js"><link rel="prefetch" href="/assets/js/9.e2efb1a3.js"><link rel="prefetch" href="/assets/js/90.0072bf0a.js"><link rel="prefetch" href="/assets/js/91.5d2f0718.js"><link rel="prefetch" href="/assets/js/92.cd63c6fa.js"><link rel="prefetch" href="/assets/js/93.b78f628a.js"><link rel="prefetch" href="/assets/js/94.79f6f1eb.js"><link rel="prefetch" href="/assets/js/95.09e5bb00.js"><link rel="prefetch" href="/assets/js/96.d094370d.js"><link rel="prefetch" href="/assets/js/97.785a65a8.js"><link rel="prefetch" href="/assets/js/98.77712e31.js"><link rel="prefetch" href="/assets/js/99.6386501d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.5bd792e7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-1156296a><div data-v-1156296a><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-1156296a data-v-1156296a><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-4e82dffc data-v-1156296a data-v-1156296a><h3 class="title" data-v-4e82dffc data-v-4e82dffc>frenchleave</h3> <p class="description" data-v-4e82dffc data-v-4e82dffc>冯春齐 fengchunqi frenchleave blog</p> <label id="box" class="inputBox" data-v-4e82dffc data-v-4e82dffc><input type="password" value="" data-v-4e82dffc> <span data-v-4e82dffc>Konck! Knock!</span> <button data-v-4e82dffc>OK</button></label> <div class="footer" data-v-4e82dffc data-v-4e82dffc><span data-v-4e82dffc><i class="iconfont reco-theme" data-v-4e82dffc></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-4e82dffc>vuePress-theme-reco</a></span> <span data-v-4e82dffc><i class="iconfont reco-copyright" data-v-4e82dffc></i> <a data-v-4e82dffc><span data-v-4e82dffc>fengchunqi</span>
            
          <span data-v-4e82dffc>2020 - </span>
          2024
        </a></span></div></div> <div class="hide" data-v-1156296a><header class="navbar" data-v-1156296a><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/avatar.jpg" alt="frenchleave" class="logo"> <span class="site-name">frenchleave</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/About/" class="nav-link"><i class="undefined"></i>
  About
</a></li><li class="dropdown-item"><!----> <a href="/categories/Articles/" class="nav-link"><i class="undefined"></i>
  Articles
</a></li><li class="dropdown-item"><!----> <a href="/categories/Poem/" class="nav-link"><i class="undefined"></i>
  Poem
</a></li><li class="dropdown-item"><!----> <a href="/categories/Study/" class="nav-link"><i class="undefined"></i>
  Study
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><a href="/pages/comments/" class="nav-link"><i class="iconfont reco-suggestion"></i>
  留言板
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      更多
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/about/author.html" class="nav-link"><i class="undefined"></i>
  关于作者
</a></li><li class="dropdown-item"><!----> <a href="/pages/about/website.html" class="nav-link"><i class="undefined"></i>
  关于本站
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-1156296a></div> <aside class="sidebar" data-v-1156296a><div class="personal-info-wrapper" data-v-828910c6 data-v-1156296a><img src="/avatar.jpg" alt="author-avatar" class="personal-img" data-v-828910c6> <h3 class="name" data-v-828910c6>
    fengchunqi
  </h3> <div class="num" data-v-828910c6><div data-v-828910c6><h3 data-v-828910c6>117</h3> <h6 data-v-828910c6>文章</h6></div> <div data-v-828910c6><h3 data-v-828910c6>20</h3> <h6 data-v-828910c6>标签</h6></div></div> <ul class="social-links" data-v-828910c6></ul> <hr data-v-828910c6></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/About/" class="nav-link"><i class="undefined"></i>
  About
</a></li><li class="dropdown-item"><!----> <a href="/categories/Articles/" class="nav-link"><i class="undefined"></i>
  Articles
</a></li><li class="dropdown-item"><!----> <a href="/categories/Poem/" class="nav-link"><i class="undefined"></i>
  Poem
</a></li><li class="dropdown-item"><!----> <a href="/categories/Study/" class="nav-link"><i class="undefined"></i>
  Study
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><a href="/pages/comments/" class="nav-link"><i class="iconfont reco-suggestion"></i>
  留言板
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      更多
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/about/author.html" class="nav-link"><i class="undefined"></i>
  关于作者
</a></li><li class="dropdown-item"><!----> <a href="/pages/about/website.html" class="nav-link"><i class="undefined"></i>
  关于本站
</a></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Algorithm</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Git</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HTML</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>HTTP</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/articles/http/tcpde-san-ci-wo-shou-yu-si-ci-hui-shou.html" aria-current="page" class="active sidebar-link">TCP的三次握手与四次挥手</a></li><li><a href="/pages/articles/http/osiqi-ceng-mo-xing-yu-tcpipwu-ceng-mo-xing.html" class="sidebar-link">OSI七层模型与TCPIP五层模型</a></li><li><a href="/pages/articles/http/qian-duan-huan-cun-xiang-guan.html" class="sidebar-link">前端缓存相关</a></li><li><a href="/pages/articles/http/wei-shi-me-xu-yao-urlbian-ma.html" class="sidebar-link">为什么需要URL编码</a></li><li><a href="/pages/articles/http/dnsjie-xi-liu-cheng-yi-ji-qian-duan-you-hua.html" class="sidebar-link">DNS解析流程以及前端优化</a></li><li><a href="/pages/articles/http/httpyu-https.html" class="sidebar-link">HTTP与HTTPS</a></li><li><a href="/pages/articles/http/http0de-qu-bie.html" class="sidebar-link">HTTP1.0,1.1,2.0的区别</a></li><li><a href="/pages/articles/http/httpchang-jian-de-zhuang-tai-ma-yi-ji-qing-qiu-tou.html" class="sidebar-link">HTTP常见的状态码以及请求头</a></li><li><a href="/pages/articles/http/httpsxie-yi-shi-ru-he-bao-zheng-an-quan-de.html" class="sidebar-link">HTTPS协议是如何保证安全的</a></li><li><a href="/pages/articles/http/chang-jian-wang-zhan-gong-ji-ji-shu.html" class="sidebar-link">常见网站攻击技术</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Interview</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Linux</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>NPM</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>React</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>TypeScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>VSCode</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-4e82dffc data-v-1156296a><h3 class="title" data-v-4e82dffc data-v-4e82dffc>TCP的三次握手与四次挥手</h3> <!----> <label id="box" class="inputBox" data-v-4e82dffc data-v-4e82dffc><input type="password" value="" data-v-4e82dffc> <span data-v-4e82dffc>Konck! Knock!</span> <button data-v-4e82dffc>OK</button></label> <div class="footer" data-v-4e82dffc data-v-4e82dffc><span data-v-4e82dffc><i class="iconfont reco-theme" data-v-4e82dffc></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-4e82dffc>vuePress-theme-reco</a></span> <span data-v-4e82dffc><i class="iconfont reco-copyright" data-v-4e82dffc></i> <a data-v-4e82dffc><span data-v-4e82dffc>fengchunqi</span>
            
          <span data-v-4e82dffc>2020 - </span>
          2024
        </a></span></div></div> <div data-v-1156296a><main class="page"><section><div class="page-title"><h1 class="title">TCP的三次握手与四次挥手</h1> <div data-v-1ff7123e><i class="iconfont reco-account" data-v-1ff7123e><span data-v-1ff7123e>fengchunqi</span></i> <i class="iconfont reco-date" data-v-1ff7123e><span data-v-1ff7123e>2021/5/13</span></i> <i class="iconfont reco-eye" data-v-1ff7123e><span id="/pages/articles/http/tcpde-san-ci-wo-shou-yu-si-ci-hui-shou.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-1ff7123e><a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;"></a></span></i> <i class="tags iconfont reco-tag" data-v-1ff7123e><span class="tag-item" data-v-1ff7123e>HTTP</span></i></div></div> <div class="theme-reco-content content__default"><div class="custom-block tip"><p class="custom-block-title">TIPS</p> <p>版权声明：本文为CSDN博主「青柚_」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。</p> <p>原文链接：<a href="https://blog.csdn.net/qq_38950316/article/details/81087809" target="_blank" rel="nofollow noopener noreferrer">TCP的三次握手与四次挥手理解及面试题（很全面）<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <h2 id="基础知识"><a href="#基础知识" class="header-anchor">#</a> 基础知识</h2> <div class="img-container" data-v-a458ecf0><div class="img-wrapper" style="width:;height:;max-width:100px;max-height:100px;" data-v-a458ecf0><img src="/image-default.png" alt="image-default" class="image-default" data-v-a458ecf0></img></div></div> <ol><li>序列号seq：占4个字节，用来标记数据段的顺序，TCP把连接中发送的所有数据字节都编上一个序号，第一个字节的编号由本地随机产生；给字节编上序号后，就给每一个报文段指派一个序号；序列号seq就是这个报文段中的第一个字节的数据编号。</li> <li>确认号ack：占4个字节，期待收到对方下一个报文段的第一个数据字节的序号；序列号表示报文段携带数据的第一个字节的编号；而确认号指的是期望接收到下一个字节的编号；因此当前报文段最后一个字节的编号+1即为确认号。</li> <li>确认ACK：占1位，仅当ACK=1时，确认号字段才有效。ACK=0时，确认号无效</li> <li>同步SYN：连接建立时用于同步序号。当SYN=1，ACK=0时表示：这是一个连接请求报文段。若同意连接，则在响应报文段中使得SYN=1，ACK=1。因此，SYN=1表示这是一个连接请求，或连接接受报文。SYN这个标志位只有在TCP建立连接时才会被置1，握手完成后SYN标志位被置0。</li> <li>终止FIN：用来释放一个连接。FIN=1表示：此报文段的发送方的数据已经发送完毕，并要求释放运输连接</li></ol> <table><thead><tr><th>字段</th> <th>含义</th></tr></thead> <tbody><tr><td>URG</td> <td>紧急指针是否有效。为1，表示某一位需要被优先处理</td></tr> <tr><td>ACK</td> <td>确认号是否有效，一般置为1。</td></tr> <tr><td>PSH</td> <td>提示接收端应用程序立即从TCP缓冲区把数据读走。</td></tr> <tr><td>RST</td> <td>对方要求重新建立连接，复位。</td></tr> <tr><td>SYN</td> <td>请求建立连接，并在其序列号的字段进行序列号的初始值设定。建立连接，设置为1</td></tr> <tr><td>FIN</td> <td>希望断开连接。</td></tr></tbody></table> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>ACK、SYN和FIN这些大写的单词表示标志位，其值要么是1，要么是0；ack、seq小写的单词表示序号。</p></div> <h2 id="三次握手"><a href="#三次握手" class="header-anchor">#</a> 三次握手</h2> <div class="img-container" data-v-a458ecf0><div class="img-wrapper" style="width:;height:;max-width:100px;max-height:100px;" data-v-a458ecf0><img src="/image-default.png" alt="image-default" class="image-default" data-v-a458ecf0></img></div></div> <ol><li>第一次握手：客户端发送建立连接请求的报文到服务器，它的SYN标志位为1，初始序号为seq=x，并进入**SYN-SENT（同步已发送）**状态，等待服务器确认；SYN：同步序列编号（Synchronize Sequence Numbers）（此报文不携带数据，但需要消耗一个序号）。</li> <li>第二次握手：服务器收到连接请求的报文段，如果同意建立连接，则向客户端发送确认报文，此时SYN和ACK标志位置为1，确认号是ack=x+1，同时自己也选择一个初始序号为seq=y，此时服务器进入**SYN-RCVD（同步收到）**状态（此报文不携带数据，但需要消耗一个序号）。</li> <li>第三次握手：客户端收到服务器的确认报文后，还需要向服务器发送确认。确认报文的ACK标志位为1，确认号为ack=y+1，而自己的序号为seq=x+1，此包发送完毕，客户端和服务器进入**ESTABLISHED（已建立连接）**状态，完成三次握手（此报文可以携带数据，但如果不携带数据，则不消耗序号，下一个数据报文段的序号仍是seq=x+1。比如HTTP的请求就是在TCP的第三次握手报文中发送到服务器的）。</li></ol> <h2 id="四次挥手"><a href="#四次挥手" class="header-anchor">#</a> 四次挥手</h2> <div class="img-container" data-v-a458ecf0><div class="img-wrapper" style="width:;height:;max-width:100px;max-height:100px;" data-v-a458ecf0><img src="/image-default.png" alt="image-default" class="image-default" data-v-a458ecf0></img></div></div> <ol><li>客户端进程发出连接释放报文，并且停止发送数据。释放数据报文首部，FIN=1，其序列号为seq=u（等于前面已经传送过来的数据的最后一个字节的序号加1），此时，客户端进入**FIN-WAIT-1（终止等待1）**状态。TCP规定，FIN报文段即使不携带数据，也要消耗一个序号。</li> <li>服务器收到连接释放报文，发出确认报文，ACK=1，ack=u+1，并且带上自己的序列号seq=v，此时，服务端就进入了<strong>CLOSE-WAIT（关闭等待）<strong>状态。TCP服务器通知高层的应用进程，客户端向服务器的方向就释放了，这时候处于半关闭状态，即客户端已经没有数据要发送了，但是服务器若发送数据，客户端依然要接受。这个状态还要持续一段时间，也就是整个</strong>CLOSE-WAIT</strong>状态持续的时间。</li> <li>客户端收到服务器的确认请求后，此时，客户端就进入**FIN-WAIT-2（终止等待2）**状态，等待服务器发送连接释放报文（在这之前还需要接受服务器发送的最后的数据）。</li> <li>服务器将最后的数据发送完毕后，就向客户端发送连接释放报文，FIN=1，ack=u+1，由于在半关闭状态，服务器很可能又发送了一些数据，假定此时的序列号为seq=w，此时，服务器就进入了**LAST-ACK（最后确认）**状态，等待客户端的确认。</li> <li>客户端收到服务器的连接释放报文后，必须发出确认，ACK=1，ack=w+1，而自己的序列号是seq=u+1，此时，客户端就进入了<strong>TIME-WAIT（时间等待）<strong>状态。注意此时TCP连接还没有释放，必须经过2MSL（最长报文段寿命）的时间后，当客户端撤销相应的TCB（在同一时刻，设备可能会产生多种数据需要分发给不同的设备，为了确保数据能够正确分发，TCP用一种叫做TCB，也叫传输控制块的数据结构把发给不同设备的数据封装起来）后，才进入</strong>CLOSED</strong>状态。</li> <li>服务器只要收到了客户端发出的确认，立即进入<strong>CLOSED</strong>状态。同样，撤销TCB后，就结束了这次的TCP连接。可以看到，服务器结束TCP连接的时间要比客户端早一些。</li></ol> <h2 id="常见面试题"><a href="#常见面试题" class="header-anchor">#</a> 常见面试题</h2> <ul><li><p>问题一：为什么连接的时候是三次握手，关闭的时候却是四次挥手？</p> <p>因为当Server端收到Client端的SYN连接请求报文后，可以直接发送SYN+ACK报文。其中ACK报文是用来应答的，SYN报文是用来同步的。但是关闭连接时，当Server端收到FIN报文时，很可能并不会立即关闭SOCKET，所以只能先回复一个ACK报文，告诉Client端：“你发的FIN报文我收到了”。只有等到我Server端所有的报文都发送完了，我才能发送FIN报文，因此不能一起发送。故需要四次挥手。</p></li> <li><p>问题二：为什么TIME-WAIT状态需要经过2MSL（最大报文段生存时间）才能返回到CLOSE状态？</p> <p>虽然按道理，四个报文都发送完毕，我们可以直接进入<strong>CLOSE</strong>状态了，但是我们必须假想网络是不可靠的，有可能最后一个ACK丢失。所以<strong>TIME-WAIT</strong>状态就是用来重发可能丢失的ACK报文。在Client发送出最后的ACK回复，但该ACK可能丢失。Server如果没有收到ACK，将不断重复发送FIN片段。所以Client不能立即关闭，它必须确认Server接收到了该ACK。Client会在发送出ACK之后进入到<strong>TIME-WAIT</strong>状态。Client会设置一个计时器，等待2MSL的时间。如果在该时间内再次收到FIN，那么Client会重发ACK并再次等待2MSL。所谓的2MSL是两倍的MSL(Maximum Segment Lifetime)。MSL指一个片段在网络中最大的存活时间，2MSL就是一个发送和一个回复所需的最大时间。如果直到2MSL，Client都没有再次收到FIN，那么Client推断ACK已经被成功接收，则结束TCP连接。</p></li> <li><p>问题三：为什么不能用两次握手进行连接？</p> <p>3次握手完成两个重要的功能，既要双方做好发送数据的准备工作（双方都知道彼此已准备好），也要允许双方就初始序列号进行协商，这个序列号在握手过程中被发送和确认。</p> <p>基本思想就是“让我知道你已经知道了”。服务器监听请求，客户端发起连接请求（第一次连接），请求在路上可能存在丢失的风险，所以当请求到了服务器后如果服务器同意建立连接会给客户端一个回信（第二次连接），告诉它：我已经收到请求，可以连接。但是回信也存在一个问题，那就是回信能不能到客户端？它需要客户端给他一个回信说我已经收到批准通知了，如果客户端一直不回复的话意味着客户端没有收到批准通知。因此客户端一收到批准通知就立马回复（第三次握手）：我收到你的批准通知了。至此，三次握手结束。</p> <p>现在把三次握手改成仅需要两次握手，死锁是可能发生的。作为例子，考虑计算机S和C之间的通信，假定C给S发送一个连接请求分组，S收到了这个分组，并发送了确认应答分组。按照两次握手的协定，S认为连接已经成功地建立了，可以开始发送数据分组。可是，C在S的应答分组在传输中被丢失的情况下，将不知道S是否已准备好，不知道S建立什么样的序列号，C甚至怀疑S是否收到自己的连接请求分组。在这种情况下，C认为连接还未建立成功，将忽略S发来的任何数据分组，只等待连接确认应答分组。而S在发出的分组超时后，重复发送同样的分组。这样就形成了死锁。</p></li> <li><p>问题四：如果已经建立了连接，但是客户端突然出现故障了怎么办？</p> <p>TCP还设有一个保活计时器，显然，客户端如果出现故障，服务器不能一直等下去，白白浪费资源。服务器每收到一次客户端的请求后都会重新复位这个计时器，时间通常是设置为2小时，若两小时还没有收到客户端的任何数据，服务器就会发送一个探测报文段，以后每隔75秒钟发送一次。若一连发送10个探测报文仍然没反应，服务器就认为客户端出了故障，接着就关闭连接。</p></li></ul></div></section> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最近更新: </span> <span class="time">2024年09月09日 17:54:45</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/pages/articles/html/chong-pai-he-chong-hui.html" class="prev">
            重排和重绘
          </a></span> <span class="next"><a href="/pages/articles/http/osiqi-ceng-mo-xing-yu-tcpipwu-ceng-mo-xing.html">
            OSI七层模型与TCPIP五层模型
          </a></span></p></div> <div class="comments-wrapper" style="display:none;"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-70334359><li class="level-2" data-v-70334359><a href="/pages/articles/http/tcpde-san-ci-wo-shou-yu-si-ci-hui-shou.html#基础知识" class="sidebar-link reco-side-基础知识" data-v-70334359>基础知识</a></li><li class="level-2" data-v-70334359><a href="/pages/articles/http/tcpde-san-ci-wo-shou-yu-si-ci-hui-shou.html#三次握手" class="sidebar-link reco-side-三次握手" data-v-70334359>三次握手</a></li><li class="level-2" data-v-70334359><a href="/pages/articles/http/tcpde-san-ci-wo-shou-yu-si-ci-hui-shou.html#四次挥手" class="sidebar-link reco-side-四次挥手" data-v-70334359>四次挥手</a></li><li class="level-2" data-v-70334359><a href="/pages/articles/http/tcpde-san-ci-wo-shou-yu-si-ci-hui-shou.html#常见面试题" class="sidebar-link reco-side-常见面试题" data-v-70334359>常见面试题</a></li></ul></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:50%;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/assets/js/app.5f2c876c.js" defer></script><script src="/assets/js/3.83a3aa92.js" defer></script><script src="/assets/js/1.1efd4ac0.js" defer></script><script src="/assets/js/53.e9c895e1.js" defer></script><script src="/assets/js/11.a144a0bb.js" defer></script>
  </body>
</html>
